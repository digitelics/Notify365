 {% load static %}
 <div class="xl:pl-96">
    <article  id="customer-detail-none" class="border-l border-gray-200 mt-14 h-screen flex items-center justify-center bg-gray-700 bg-opacity-50">
        <div class="inset-0 z-50 mt-14 flex items-center justify-center">
            <h2 class="text-white">No customer selected.</h2>
            <span class="sr-only">No data</span>
        </div>
    </article>
        
    <article id="customer-details" class="border-l hidden border-gray-200 mt-14">
      <div class="bg-white fit-content">
        <!-- Profile header -->
        <div>
          <div>
            <img class="h-32 w-full object-cover lg:h-48" src={% static 'images/adv-customers.png' %} alt="banner-customer">
          </div>
          <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
            <div class="-mt-12 sm:-mt-16 sm:flex sm:items-end sm:space-x-5">
              <div class="flex">
                <img class="h-24 w-24 rounded-full ring-4 ring-white sm:h-32 sm:w-32" src={% static 'images/customer-avatar.png' %} alt="customer">
              </div>
              <div class="mt-6 sm:flex sm:min-w-0 sm:flex-1 sm:items-center sm:justify-end sm:space-x-6 sm:pb-1">
                <div class="mt-6 min-w-0 flex-1 sm:hidden 2xl:block">
                  {% if data.customer_created.first_name %}
                      <h1 id="customerName" class="truncate text-2xl font-bold text-gray-900 text-wrap" id="customerName"><span id="detail-first-name">{{data.customer_created.first_name}} </span> <span id="detail-last-name">{{data.customer_created.last_name}} </span></h1>
                      <span class='hidden' id='customer-id'>{{data.customer_created.id}}</span>
                  {% else %}
                      <h1 id="customerName" class="truncate text-2xl font-bold text-gray-900 text-wrap" id="customerName"><span id="detail-first-name"></span> <span id="detail-last-name"></span></h1>
                       <span class='hidden' id='customer-id'></span>
                  {% endif %}
                </div>
                <div class="mt-6 flex flex-col justify-stretch space-y-3 sm:flex-row sm:space-x-2 sm:space-y-0">
                {% if data.customer_created.id %}
                   <button  id="edit-customer-btn" data-customer-id={{data.customer_created.id}} data-customer-phone="{{data.customer_created.phone}}" data-customer-email="{{data.customer_created.email}}" data-customer-dob="{{data.customer_created.dob}}" data-customer-gender="{{data.customer_created.gender}}" data-customer-name="{{data.customer_created.first_name}}" data-customer-lastname="{{data.customer_created.last_name}}" data-customer-state="{{data.customer_state.state}}" data-customer-city="{{data.customer_created.city}}" data-customer-zipcode="{{data.customer_created.zip_code}}" data-customer-street="{{data.customer_created.street}}" class="inline-flex justify-center gap-x-1.5 rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-green-700 edit-customer-btn">
                    <svg viewBox="0 0 24 24" fill="currentColor" class="-ml-0.5 h-5 w-5 text-white">
                      <path d="M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-8.4 8.4a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32l8.4-8.4Z" />
                      <path d="M5.25 5.25a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3V13.5a.75.75 0 0 0-1.5 0v5.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5V8.25a1.5 1.5 0 0 1 1.5-1.5h5.25a.75.75 0 0 0 0-1.5H5.25Z" />
                      </svg>
                    Edit
                  </button>
                  <button id="delete-customer-btn" data-customer-id={{data.customer_created.id}} class="delete-customer-btn inline-flex justify-center gap-x-1.5 rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-red-700 ">
                    <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="-ml-0.5 h-5 w-5 text-white">
                      <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                  </svg>
                    Delete
                  </button>
                {% else %}
                   <button id="edit-customer-btn" class="inline-flex justify-center gap-x-1.5 rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-green-700 edit-customer-btn">
                    <svg viewBox="0 0 24 24" fill="currentColor" class="-ml-0.5 h-5 w-5 text-white">
                      <path d="M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-8.4 8.4a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32l8.4-8.4Z" />
                      <path d="M5.25 5.25a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3V13.5a.75.75 0 0 0-1.5 0v5.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5V8.25a1.5 1.5 0 0 1 1.5-1.5h5.25a.75.75 0 0 0 0-1.5H5.25Z" />
                      </svg>
                    Edit
                  </button>
                  <button id="delete-customer-btn" class="delete-customer-btn inline-flex justify-center gap-x-1.5 rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-red-700 ">
                    <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="-ml-0.5 h-5 w-5 text-white">
                      <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                  </svg>
                    Delete
                  </button>
                {% endif %}
                 
                  
                  <span class="inline-flex rounded-md shadow-sm">
                    <button onclick="toggleModal('modal-email')" type="button" class="inline-flex items-center gap-x-1.5 rounded-l-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:z-10 hover:bg-gray-100 focus:z-10">
                      <svg class="-ml-0.5 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path d="M3 4a2 2 0 00-2 2v1.161l8.441 4.221a1.25 1.25 0 001.118 0L19 7.162V6a2 2 0 00-2-2H3z" />
                        <path d="M19 8.839l-7.77 3.885a2.75 2.75 0 01-2.46 0L1 8.839V14a2 2 0 002 2h14a2 2 0 002-2V8.839z" />
                      </svg>
                      E-mail
                    </button>
                    <button onclick="toggleModal('modal-text')" type="button" class="-ml-px hidden items-center gap-x-1.5 bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:z-10 hover:bg-gray-100 focus:z-10 sm:inline-flex">
                      <svg class="-ml-0.5 h-5 w-5 text-gray-400" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M4.804 21.644A6.707 6.707 0 0 0 6 21.75a6.721 6.721 0 0 0 3.583-1.029c.774.182 1.584.279 2.417.279 5.322 0 9.75-3.97 9.75-9 0-5.03-4.428-9-9.75-9s-9.75 3.97-9.75 9c0 2.409 1.025 4.587 2.674 6.192.232.226.277.428.254.543a3.73 3.73 0 0 1-.814 1.686.75.75 0 0 0 .44 1.223ZM8.25 10.875a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25ZM10.875 12a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875-1.125a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25Z" clip-rule="evenodd" />
                      </svg>
                      Text Message
                    </button>
                    <button onclick="toggleSimpleModal('modal-callconfirmation')" type="button" class="-ml-px hidden items-center gap-x-1.5 rounded-r-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:z-10 hover:bg-gray-100 focus:z-10 sm:inline-flex">
                      <svg class="-ml-0.5 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M2 3.5A1.5 1.5 0 013.5 2h1.148a1.5 1.5 0 011.465 1.175l.716 3.223a1.5 1.5 0 01-1.052 1.767l-.933.267c-.41.117-.643.555-.48.95a11.542 11.542 0 006.254 6.254c.395.163.833-.07.95-.48l.267-.933a1.5 1.5 0 011.767-1.052l3.223.716A1.5 1.5 0 0118 15.352V16.5a1.5 1.5 0 01-1.5 1.5H15c-1.149 0-2.263-.15-3.326-.43A13.022 13.022 0 012.43 8.326 13.019 13.019 0 012 5V3.5z" clip-rule="evenodd" />
                      </svg>
                      Call 
                    </button>
                  </span>
                </div>
              </div>
            </div>
            <div class="mt-6 hidden min-w-0 flex-1 sm:block 2xl:hidden">
              <h1 class="truncate text-2xl font-bold text-gray-900">Ricardo Cooper</h1>
            </div>
          </div>
        </div>

        <!-- Tabs -->
        <div class="mt-6 sm:mt-2 2xl:mt-5">
        <div class="border-b border-gray-200">
          <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
            <nav class="-mb-px flex space-x-8" aria-label="Tabs">
              <!-- Current: "border-pink-500 text-gray-900", Default: "border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" -->
              <a href="#" onclick="openTab(event, 'datails')" class="tablinks border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium" aria-current="page">Profile</a>
              <a href="#" onclick="openTab(event, 'timeline')" class="tablinks border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium">Timeline</a>
              <a href="#" onclick="openTab(event, 'notification')" class="tablinks border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium">Notifications</a>
            </nav>
          </div>
        </div>
        </div>
      </div>
      <!-- Description list -->
      <div id="datails" class="tabcontent">
        <div class=" mx-auto mt-6 max-w-5xl px-4 sm:px-6 lg:px-8">
          <dl class="grid grid-cols-1 gap-x-4 gap-y-8 sm:grid-cols-2">
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Phone</dt>
              <dd id="detail-phone" class="mt-1 text-sm text-gray-900">{{data.customer_created.phone}}</dd>
              <input id="customerPhoneNumber" type="tel" hidden value=""></input>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Email</dt>
              <dd id="detail-email" class="mt-1 text-sm text-gray-900">{{data.customer_created.email}}</dd>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Date of birth</dt>
              <dd id="detail-dob" class="mt-1 text-sm text-gray-900">{{data.customer_created.dob}}</dd>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Age</dt>
              <dd class="mt-1 text-sm text-gray-900" id="customer-age"></dd>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Gender</dt>
              <dd id="detail-gender" class="mt-1 text-sm text-gray-900">{{data.customer_created.gender}}</dd>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Register By</dt>
              <dd id="detail-created-by" class="mt-1 text-sm text-gray-900">{{data.customer_created.created_by}}</dd>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Status</dt>
              <dd id="detail-customer-status" class="mt-1 text-sm text-gray-900">{{data.customer_created.customer_status}}</dd>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Last change</dt>
              <dd id="detail-last-change" class="mt-1 text-sm text-gray-900">{{data.customer_created.updated_at}}</dd>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">Address</dt>
              <dd id="detail-street" class="mt-1 text-sm text-gray-900">{{data.customer_created.street}}</dd>
            </div>
            <div class="sm:col-span-1">
              <dt class="text-sm font-medium text-gray-500">City</dt>
              <dd id="detail-city" class="mt-1 text-sm text-gray-900">{{data.customer_created.city}}</dd>
            </div>
            
          </dl>
        </div>

        <!-- CUSTOMER BLOCK -->

        <div class="px-4 bg-gray-100 sm:px-6 m-5 py-4 lg:px-8 border-dashed rounded-lg" id="customer-deal-block">
            <div class="sm:flex sm:items-center">
                <div class="sm:flex-auto">
                <h1 class="text-base font-semibold leading-6 text-gray-900">Customer Deals</h1>
                <p class="mt-2 text-sm text-gray-700">A list of all deals that the customer has made with our Company.</p>
                </div>
                <div class="mt-4 sm:ml-16 sm:mt-0 sm:flex-none">
                <button onclick="toggleModal('modal-deal')" title="New deal" type="button" class="block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Add new deal</button>
                </div>
            </div>
            <div class="mt-8 flow-root">
                <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
                <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
                    <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg">
                    <table class="min-w-full divide-y divide-gray-300">
                        <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">Code</th>
                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Service</th>
                             <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Provider</th>
                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Deal amount</th>
                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Expiration date</th>
                            <th scope="col" width="100" class="relative py-3.5 pl-3 pr-4 sm:pr-6">
                            <span class="sr-only">Edit</span>
                            </th>
                        </tr>
                        </thead>
                        {% if data.deals %}
                         <tbody id="deals-elements" class="divide-y divide-gray-200 bg-white">
                          {% for deal in data.deals %}
                              <tr class="{% if deal.deactivation_date >= data.today and deal.product_status == 'active' %} text-blue-500 {% else %} text-gray-400 {% endif %}">
                                <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium sm:pl-6">{{ deal.code }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm">{{ deal.product_status }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm">{{ deal.provider_name }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm">{{ deal.base_premium }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm">{{ deal.deactivation_date }}</td>
                                <td class="whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                  <div class="flex flex-1 gap-2 justify-end">
                                    <!-- Botón Editar -->
                                    <a onclick="{% if deal.deactivation_date >= data.today and deal.product_status == 'active' %}toggleModal('modal-deal'){% endif %}" title="Edit" class="{% if deal.deactivation_date >= data.today and deal.product_status == 'active' %}text-green-500 hover:text-green-300{% else %}text-gray-400 cursor-not-allowed{% endif %}">
                                      <span title="Edit deal">
                                        <svg class="w-6 h-6" fill="none" viewBox="0 0 26 26" stroke-width="1.5" stroke="currentColor">
                                          <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487z" />
                                        </svg>
                                      </span>
                                    </a>
                                    <!-- Botón Cancelar -->
                                    <a href="#customer-deal-block" title="Cancel" class="{% if deal.deactivation_date >= data.today and deal.product_status == 'active' %}text-orange-600 hover:text-orange-400{% else %}text-gray-400 cursor-not-allowed{% endif %}">
                                      <span title="Cancel deal">
                                        <svg class="w-6 h-6" fill="none" viewBox="0 0 26 26" stroke-width="1.5" stroke="currentColor">
                                          <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m6 4.125l2.25 2.25m0 0l2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
                                        </svg>
                                      </span>
                                    </a>
                                    <!-- Botón Eliminar -->
                                    <a href="#customer-deal-block" title="Delete" onclick="{% if deal.deactivation_date >= data.today and deal.product_status == 'active' %}toggleModal('modal-deletedeal'){% endif %}" class="{% if deal.deactivation_date >= data.today and deal.product_status == 'active' %}text-red-600 hover:text-red-400{% else %}text-gray-400 cursor-not-allowed{% endif %}">
                                      <span title="Remove deal">
                                        <svg class="w-6 h-6" fill="none" viewBox="0 0 26 26" stroke-width="1.5" stroke="currentColor">
                                          <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                                        </svg>
                                      </span>
                                    </a>
                                  </div>
                                </td>
                              </tr>
                          {% endfor %}
                           </tbody>
                        {% else %}
                            <tbody id="deals-elements" class="divide-y divide-gray-200 bg-white"></tbody>
                        {% endif %}
                    </table>
                    </div>
                </div>
                </div>
            </div>
        </div>

        <!-- NOTE BLOCK -->

        <div class="px-4 bg-gray-100 sm:px-6 m-5 py-4 lg:px-8 border-dashed rounded-lg" id="customer-notes-block">
            <div class="sm:flex sm:items-center">
              <div class="sm:flex-auto">
                <h1 class="text-base font-semibold leading-6 text-gray-900">Customer Notes</h1>
                <p class="mt-2 text-sm text-gray-700">A list of notes to have a record of all interactions with the current client.</p>
              </div>
              <div class="mt-4 sm:ml-16 sm:mt-0 sm:flex-none">
                <button onclick="toggleModal('modal-note')" type="button" class="block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Add new note</button>
              </div>
            </div>
          <div class="mt-8 flow-root">
              <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
              <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
                  <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg">
                  <table class="min-w-full divide-y divide-gray-300">
                      <thead class="bg-gray-50">
                      <tr>
                          <th scope="col" WIDTH="600" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">Notes</th>
                          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Date</th>
                          <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Created By</th>
                          <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6">
                          <span class="sr-only">Edit</span>
                          </th>
                      </tr>
                      </thead>
                      {% if data.notes %}
                          {% for note in data.notes %}
                             <tbody id='notes_elements' class="divide-y divide-gray-200 bg-white">
                              <tr>
                                <td class="py-4 pl-4 pr-3 text-sm font-medium text-gray-500 sm:pl-6"> {{note.note}} </td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500"> {{note.date}} </td>
                                <td class="px-3 py-4 text-sm text-gray-500"> {{note.created_by_name}} </td>
                                <td class="whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                  <div class="flex flex-1 gap-2 justify-end">
                                      <a href="#customer-deal-block" onclick="toggleModal("modal-deal")"  title="Edit"><span title="Edit deal">
                                        <svg fill="none" viewBox="0 0 26 26" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-green-500 hover:text-green-300">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125" />
                                        </svg></span>
                                      </a>
                                      <a href="#customer-deal-block" title="Delete" onclick="toggleModal("modal-deletedeal")"><span title="Remove deal">
                                        <svg fill="none" viewBox="0 0 26 26" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-red-600 hover:text-red-400">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                                        </svg></span>
                                      </a>
                                  </div>
                                </td>
                              </tr>
                             
                             </tbody>
                          {% endfor %}
                      {% else %}
                         <tbody id='notes_elements' class="divide-y divide-gray-200 bg-white"></tbody>
                      {% endif %}
                     
                  </table>
                  </div>
              </div>
              </div>
          </div>
          </div>

          <!-- ATTACHMENTS SECTION -->

          <div class="px-4 bg-gray-100 sm:px-6 m-5 py-4 lg:px-8 border-dashed rounded-lg" id="customer-attach-block">
              <div class="sm:flex sm:items-center">
                  <div class="sm:flex-auto">
                  <h1 class="text-base font-semibold leading-6 text-gray-900">Attachments</h1>
                  <p class="mt-2 text-sm text-gray-700">A list of documents uploaded for the current client.</p>
                  </div>
                  <div class="mt-4 sm:ml-16 sm:mt-0 sm:flex-none">
                  </div>
              </div>
              <div class="mt-8 flow-root">
                  <div class="col-span-4 sm:col-span-4">
                          <div class="flex items-center justify-center w-full">
                              <div  onclick="toggleModal('modal-attachments')" class="flex flex-col items-center justify-center w-full h-50 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600">
                                  <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                      <svg class="w-8 h-8 mb-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"/>
                                      </svg>
                                      <p class="mb-2 text-sm text-gray-500 dark:text-gray-400"><span class="font-semibold">Upload new file</p>
                                      <p class="text-xs text-gray-500 dark:text-gray-400">(MAX. 2MB)</p>
                                  </div>
                              </div>
                          </div> 
                      </div>
                  </div>
                  <div class="overflow-hidden mt-4 shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg">
                      <table class="min-w-full divide-y divide-gray-300">
                          <thead class="bg-gray-50">
                          <tr>
                              <th scope="col" WIDTH="500" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">Document</th>
                              <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Date</th>
                              <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Uploaded By</th>
                              <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6">
                              <span class="sr-only">Edit</span>
                              </th>
                          </tr>
                          </thead>
                          {% if data.documents %}
                            <tbody id="document-elements" class="divide-y divide-gray-200 bg-white">
                            {% for document in data.documents %}
                                  <tr>
                                   {% if document.doc_path %}
                                      <td class="py-4 pl-4 pr-3 text-sm font-medium text-gray-500 sm:pl-6">
                                        <div class="flex flex-1 gap-x-2">  
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">                                         
                                              <path stroke-linecap="round" stroke-linejoin="round" d="m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13" />                                     
                                            </svg>                                     
                                            <span> {{document.document_name}} </span>                                 
                                         </div>                            
                                      </td>                            
                                      <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500"> {{ document.updated_at }} </td>
                                      <td class="whitespace-nowrap px-3 py-4 text-sm text-blue-500"> {{ document.created_by_name }}  </td>
                                      <td class="whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                        <div class="flex flex-1 gap-2 justify-end">
                                          <a href="{{ data.base_url }}{{ document.doc_path }}"  title="download"><span title="Download">
                                            <svg fill="none" viewBox="0 0 26 26" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-indigo-600 hover:text-indigo-400">
                                              <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                                            </svg>
                                          </a>
                                          <a href="#customer-attach-block" title="Delete" onclick="toggleModal("modal-deletefile")"><span title="Remove file">
                                            <svg fill="none" viewBox="0 0 26 26" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-red-600 hover:text-red-400">
                                              <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                                            </svg>
                                          </a>
                                        </div>
                                      </td>
                                   {% else %}
                                     <td class="py-4 pl-4 pr-3 text-sm font-medium text-gray-500 sm:pl-6">
                                        <div class="flex flex-1 gap-x-2">  
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m6.75 12-3-3m0 0-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                                            </svg>
                                            <span> {{ document.document_name}} </span>
                                          </div>
                                      </td>
                                      <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ document.updated_at }}</td>
                                      <td class="whitespace-nowrap px-3 py-4 text-sm text-red-500"> {{ document.created_by_name|default:"Pending" }} </td>
                                      <td class="whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                        <div class="flex flex-1 gap-2 justify-end">
                                          <span>
                                            <svg fill="none" viewBox="0 0 26 26" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-indigo-600 hover:text-indigo-400">
                                              <path stroke-linecap="round" stroke-linejoin="round" d="" />
                                            </svg>
                                          </span>
                                        </div>
                                      </td>
                                   {% endif %}
                                  </tr>
                            {% endfor %}
                             </tbody>
                          {% else %}
                               <tbody id="document-elements" class="divide-y divide-gray-200 bg-white"></tbody>
                          {% endif %}
                      </table>
                  </div>
              </div> 

        <!-- ADITIONAL CONTACT SECTION -->

        <div class="mx-auto mt-8 max-w-5xl px-4 pb-12 sm:px-6 lg:px-8">
          <div class="sm:items-center">
              <div class="text-center">
                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 48 48" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M34 40h10v-4a6 6 0 00-10.712-3.714M34 40H14m20 0v-4a9.971 9.971 0 00-.712-3.714M14 40H4v-4a6 6 0 0110.713-3.714M14 40v-4c0-1.313.253-2.566.713-3.714m0 0A10.003 10.003 0 0124 26c4.21 0 7.813 2.602 9.288 6.286M30 14a6 6 0 11-12 0 6 6 0 0112 0zm12 6a4 4 0 11-8 0 4 4 0 018 0zm-28 0a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <h2 class="mt-2 text-base font-semibold leading-6 text-gray-900">Aditional contacts</h2>
                <p class="mt-1 text-sm text-gray-500">A list of all contact related with the current client.</p>
                <div class="mt-4 sm:mt-4">
                  <button onclick="toggleModal('modal-contact')" type="button" class="rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Add new contact</button>
                </div>
              </div>
            </div>
            {% if data.contacts %}
              <div id="contact-elements" class="mt-8 grid grid-cols-1 gap-4 sm:grid-cols-2">
                {% for contact in data.contacts %}
                  <div class="relative flex items-center space-x-3 rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm focus-within:ring-2 focus-within:ring-pink-500 focus-within:ring-offset-2 hover:border-gray-400">
                    <div class="flex-shrink-0">   
                      <img class="h-10 w-10 rounded-full" src={% static 'images/user-circle-icon.png' %} alt="contact-picture">       
                    </div>
                    <div class="min-w-0 flex-1">     
                      <a href="{% url 'customer_detail' contact.contact %}" class="focus:outline-none">       
                        <span class="absolute inset-0" aria-hidden="true"></span>         
                        <p class="text-sm font-medium text-gray-900">{{contact.contact_name}} {{contact.contact_last_name}} </p>
                        <p class="truncate text-sm text-gray-500">Relationship:  {{contact.relationship}} </p>
                        <p class="truncate text-sm text-gray-500"> {{contact.contact_phone}} </p>     
                      </a>  
                    </div>     
                  </div>    
                {% endfor %}
              </div>
            {% else %}
               <div id="contact-elements" class="mt-8 grid grid-cols-1 gap-4 sm:grid-cols-2"></div>
            {% endif %}
        </div>
      </div>
    </article>
  </div>

    <script>
      window.addEventListener("DOMContentLoaded", (event) => {
          const customerName = document.getElementById("detail-first-name"); 

          if (!customerName.textContent) {
              document.getElementById('customer-detail-none').classList.remove('hidden');
          } else {
              document.getElementById('customer-detail-none').classList.add('hidden');
              document.getElementById('customer-details').classList.remove('hidden');
          }
      });

      $(document).ready(function() {
        // Evento de clic en el botón Editar customers
        // Usa la delegación de eventos para asegurar que siempre capturas el evento más reciente
          $(document).on('click', '.edit-customer-btn', function() {

              // Asegurarse de que se ha clicado en el botón correcto
              var $button = $(this);
              
              // Obtener los datos actualizados del botón clicado
              var name = $button.attr('data-customer-name');
              var last_name = $button.attr('data-customer-lastname');
              var phone = $button.attr('data-customer-phone');
              var email = $button.attr('data-customer-email');
              var dob = $button.attr('data-customer-dob');
              var gender = $button.attr('data-customer-gender');
              var id = $button.attr('data-customer-id');
              var street = $button.attr('data-customer-street');
              var zipCode = $button.attr('data-customer-zipcode');
              var city = $button.attr('data-customer-city');
              var state = $button.attr('data-customer-state');

              // Asegúrate de que los valores correctos están siendo obtenidos
              console.log('Datos obtenidos del botón:', name, last_name, phone, email, dob, gender, id, street, zipCode, city, state);

              // Actualizar el action del formulario con el ID del cliente
              var actionUrl = '{% url "edit-customer" 0 %}'.replace('0', id);
              $('#editCustomerForm').attr('action', actionUrl);
              
              // Llenar los campos del formulario con los datos obtenidos
              $('#edit-first-name').val(name);
              $('#edit-last-name').val(last_name);
              $('#edit-phone').val(phone);
              if (dob != '-'){
                $('#edit-dob').val(new Date(dob).toISOString().split('T')[0]);
              }
              if (email != '-') {
                $('#edit-email').val(email);
              }
              $('#edit-gender').val(gender).change();
              $('#edit-street').val(street);
              $('#edit-city').val(city);
              $('#edit-state').val(state).change();
              $('#edit-zip_code').val(zipCode);

              // Mostrar el modal
              toggleModal("edit-modal-customer");
          });

          // Limpiar el formulario al cerrar el modal
          $('#edit-modal-customer').on('hidden.bs.modal', function () {
              $('#editCustomerForm').trigger("reset");
          });


        // Evento de clic en el botón delete
        $('.delete-customer-btn').click(function() {
            // Obtener los datos del atributo data
            var id = $(this).data('customer-id');

            // Actualizar el action del formulario con el ID
            var actionUrl = '{% url "delete-customer" 0 %}'.replace('0', id);
            $('#deleteCustomerForm').attr('action', actionUrl);
            toggleModal("modal-delete-customer")
        });
    });
    </script>
