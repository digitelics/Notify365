{% extends "layouts/base.html" %}
{% load static %}
{% block css %}
  <link rel="stylesheet" href="{% static 'css/sms.css' %}">
{% endblock css %}
{% block title %}Notifications{% endblock %}
{% block content %}
<div class="wrapper">
    <div class="container">
        <div class="left overflow-auto">
            <div class="top fixed">
                <input class="text-left" type="text" placeholder="Search" id="searchInput" />
            </div>
            <ul class="people" id="customerList">
                {% for customer in customers %}
                    <li class="person {% if customer.id == selected_customer_id %}active{% endif %}" data-chat="person{{ forloop.counter }}" data-id="{{ customer.id }}">
                        <img src="{% static 'images/user-circle-icon.png' %}" alt="" />
                        <span class="name">{{ customer.first_name }} {{ customer.last_name }}</span>
                        <span class="time">
                            {% if customer.notifications_list %}
                                {{ customer.notifications_list.last.date|date:"H:i A" }}
                            {% endif %}
                        </span>
                        <span class="preview">
                            {% if customer.notifications_list %}
                                {{ customer.notifications_list.last.text }}
                            {% endif %}
                        </span>
                    </li>
                {% endfor %}
            </ul>
        </div>
        <div class="right">
            <div class="top"><span>To: <span class="name"></span></span></div>
            <div class="chat-container" id="chat-container">
                {% for customer in customers %}
                    <div class="chat {% if customer.id == selected_customer_id %}active-chat{% endif %}" data-chat="person{{ forloop.counter }}">
                        {% include 'notifications/notification_list.html' with customer=customer %}
                    </div>
                {% endfor %}
            </div>
            <form id="send-message-form" action="{% url 'send-chat' %}" method="POST" enctype="multipart/form-data"> 
                {% csrf_token %}
                <input type="hidden" id="customer-id" name="customer-id" value="">
                <div class="write">
                    <label for="dropzone-file" class="write-link attach cursor-pointer">
                        <input id="dropzone-file" name="document-file" type="file" class="hidden" />
                        <span id="file-name" class="ml-2"></span>
                    </label>
                    <input type="text" id="message-text" name="message-text" placeholder="Write your message..." class="message-input">
                    <button type="submit" class="write-link send"></button>
                </div>
                <div id="error-message" class="error-message text-xl -mt-8" style="color: red; display: none;"></div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
{% block script %}
    <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="{% static 'js/sms.js' %}"></script>
{% endblock script %}
